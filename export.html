<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Export Data</title>

<style>
:root{
  --primary:#00897b;
  --bg:#f4f7f6;
  --card:#ffffff;
  --danger:#e53935;
  --success:#43a047;
}

*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}

body{
  margin:0;
  background:var(--bg);
}

header{
  background:var(--primary);
  color:#fff;
  padding:14px 16px;
  display:flex;
  align-items:center;
  gap:10px;
}

header h1{
  font-size:18px;
  margin:0;
}

.back{
  cursor:pointer;
  font-size:18px;
}

.container{
  padding:16px;
  max-width:720px;
  margin:auto;
}

.card{
  background:var(--card);
  border-radius:10px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 2px 8px rgba(0,0,0,.05);
}

label{
  font-size:13px;
  font-weight:600;
  display:block;
  margin-bottom:6px;
}

input{
  width:100%;
  padding:12px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:14px;
}

input:focus{
  outline:none;
  border-color:var(--primary);
}

.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}

.records{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:14px;
}

.count{
  font-size:28px;
  font-weight:bold;
}

.btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:10px;
  font-size:15px;
  font-weight:bold;
  cursor:pointer;
  background:var(--primary);
  color:#fff;
}

.btn:disabled{
  background:#9ecfc9;
  cursor:not-allowed;
}

.note{
  font-size:13px;
  color:#555;
  line-height:1.5;
}

.empty{
  text-align:center;
  padding:30px;
  color:#777;
}
</style>
</head>

<body>

<header>
  <div class="back" onclick="history.back()">‚Üê</div>
  <h1>Export Data</h1>
</header>

<div class="container">

  <div class="card">
    <strong>Export Data</strong>
    <p class="note">
      Select a date range to export employee records.  
      Data will be exported in CSV format compatible with Excel.
    </p>
  </div>

  <div class="card">
    <div class="row">
      <div>
        <label>From Date *</label>
        <input type="date" id="fromDate" />
      </div>
      <div>
        <label>To Date *</label>
        <input type="date" id="toDate" />
      </div>
    </div>
  </div>

  <div class="card records">
    <div>
      <div>Records Found</div>
      <div class="count" id="count">0</div>
      <small id="range"></small>
    </div>
  </div>

  <button class="btn" id="exportBtn" disabled>
    üìÅ Export to CSV
  </button>

  <div class="card">
    <strong>Export Includes:</strong>
    <ul class="note">
      <li>All employee fields</li>
      <li>Entry Date & Time</li>
      <li>Excel-compatible CSV</li>
      <li>Date range filtering</li>
    </ul>
  </div>

  <div class="card empty" id="empty">
    No Records Found
  </div>

</div>

<script>
const fromDate=document.getElementById("fromDate");
const toDate=document.getElementById("toDate");
const countEl=document.getElementById("count");
const rangeEl=document.getElementById("range");
const exportBtn=document.getElementById("exportBtn");
const empty=document.getElementById("empty");

let filtered=[];

function filterData(){
  const data=JSON.parse(localStorage.getItem("employees")||"[]");
  if(!fromDate.value || !toDate.value){
    reset();
    return;
  }

  filtered=data.filter(r=>{
    return r.entryDate>=fromDate.value && r.entryDate<=toDate.value;
  });

  countEl.textContent=filtered.length;
  rangeEl.textContent=`${fromDate.value} ‚Äî ${toDate.value}`;

  if(filtered.length){
    exportBtn.disabled=false;
    empty.style.display="none";
  }else{
    exportBtn.disabled=true;
    empty.style.display="block";
  }
}

function reset(){
  countEl.textContent="0";
  rangeEl.textContent="";
  exportBtn.disabled=true;
  empty.style.display="block";
}

function exportCSV(){
  let csv="";
  const headers=Object.keys(filtered[0]);
  csv+=headers.join(",")+"\n";

  filtered.forEach(r=>{
    csv+=headers.map(h=>`"${r[h]||""}"`).join(",")+"\n";
  });

  const blob=new Blob([csv],{type:"text/csv"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="employee-data.csv";
  a.click();
}

fromDate.addEventListener("change",filterData);
toDate.addEventListener("change",filterData);
exportBtn.addEventListener("click",exportCSV);
</script>

</body>
</html>
