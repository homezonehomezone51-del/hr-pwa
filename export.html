<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Export Data</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;padding:12px}
</style>
</head>

<body>

<h2>Export Data</h2>

From: <input type="date" id="from">
To: <input type="date" id="to"><br><br>

Total Records: <span id="total">0</span><br><br>

<button onclick="exportCSV()">Export to CSV</button>

<script>
function exportCSV(){
 let data=JSON.parse(localStorage.getItem("hrData")||"[]");
 const from=document.getElementById("from").value;
 const to=document.getElementById("to").value;

 if(!from||!to){alert("Select date range");return;}

 const f=new Date(from), t=new Date(to);
 const filtered=data.filter(r=>{
   const d=new Date(r.entryDate);
   return d>=f && d<=t;
 });

 document.getElementById("total").innerText=filtered.length;
 if(!filtered.length){alert("No data");return;}

 const headers=Object.keys(filtered[0]);
 let csv=headers.join(",")+"\n";

 filtered.forEach(r=>{
   csv+=headers.map(h=>`"${r[h]||""}"`).join(",")+"\n";
 });

 const blob=new Blob([csv],{type:"text/csv"});
 const a=document.createElement("a");
 a.href=URL.createObjectURL(blob);
 a.download="hr-data.csv";
 a.click();
}
</script>

</body>
</html>
